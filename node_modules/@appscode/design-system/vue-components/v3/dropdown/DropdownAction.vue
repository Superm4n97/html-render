<script setup lang="ts">
import { defineAsyncComponent, ref } from "vue";
import HeroiconsChevronDown from "~icons/heroicons/chevron-down";
import HeroiconsChevronUp from "~icons/heroicons/chevron-up";
import { onClickOutside } from "@vueuse/core";

const AcButton = defineAsyncComponent(() => import("../button/Button.vue"));
interface Props {
  modelValue: boolean;
  title?: string;
  buttonModifierClass?: string;
  disabled?: boolean;
  iconClass: string;
}
withDefaults(defineProps<Props>(), {
  modelValue: false,
  title: "",
  buttonModifierClass: "",
  disabled: false,
  iconClass: "",
});
const actionDropdown = ref<HTMLElement | null>(null);
const emit = defineEmits(["update:modelValue"]);

onClickOutside(actionDropdown, () => emit("update:modelValue", false));
</script>

<template>
  <!-- dropdown start  -->
  <div ref="actionDropdown" class="dropdown-action" :class="{ 'dropdown is-active': modelValue }">
    <div class="dropdown-trigger">
      <ac-button
        :modifier-classes="buttonModifierClass"
        aria-haspopup="true"
        aria-controls="dropdown-menu3"
        :disabled="disabled"
        :icon-class="iconClass"
        @click="emit('update:modelValue', !modelValue)"
      >
        <template #icon>
          <slot name="icon" />
        </template>
        <span>{{ title }}</span>
        <span class="icon is-small">
          <HeroiconsChevronDown v-if="!modelValue" />
          <HeroiconsChevronUp v-else />
        </span>
      </ac-button>
    </div>
    <div class="dropdown-menu" id="dropdown-menu3" role="menu">
      <div class="dropdown-content ac-scrollbar p-0">
        <slot name="list" />
      </div>
    </div>
  </div>
  <!-- dropdown end -->
</template>
<style lang="scss">
@import "../../../vue-components/styles/components/dropdown";
</style>
