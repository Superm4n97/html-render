<script setup lang="ts">
import { defineAsyncComponent } from "vue";
import SvgSpinners270Ring from "~icons/svg-spinners/270-ring";
interface Props {
  clusterData?: {
    name?: string;
    providerIcon?: string;
    tags?: Array<{ value: string; class: string; isSpinner?: boolean }>;
    details?: Array<{ title: string; value: string }>;
  };
  modifierClasses?: string;
  showOptions?: boolean;
}

withDefaults(defineProps<Props>(), {
  clusterData: () => ({
    name: "Cluster Name",
    providerIcon: "https://via.placeholder.com/100/dddddd/808080",
    tags: [],
    details: [],
  }),
  modifierClasses: "",
  showOptions: false,
});

const OptionDots = defineAsyncComponent(() => import("../option-dots/Options.vue"));
</script>

<template>
  <div class="card-details cluster" data-testid="cluster-item-navigate">
    <option-dots v-if="showOptions" :position="'is-right'">
      <slot name="options" />
    </option-dots>
    <div class="card-details-inner" :class="modifierClasses">
      <div class="c-header">
        <div class="c-logo">
          <img :src="clusterData.providerIcon" :alt="clusterData.name" />
        </div>
        <div class="c-content">
          <div class="is-flex is-justify-content-space-between pr-32">
            <h4 data-testid="cluster-title-text">{{ clusterData.name }}</h4>
          </div>
          <div class="tags">
            <span
              v-for="(tag, idx) in clusterData.tags"
              :key="idx + tag.value"
              :class="tag.class"
              :data-testid="idx === 0 ? 'cluster-status-text' : undefined"
              class="is-flex is-align-center gap-4"
              ><span v-if="tag?.isSpinner || false" class="is-flex gap-4"><SvgSpinners270Ring /></span
              >{{ tag.value }}</span
            >
          </div>
        </div>
      </div>
      <div class="c-body">
        <p v-for="(detail, idx) in clusterData.details" :key="idx + detail.title">
          <span>{{ detail.title }}</span> <strong>{{ detail.value }}</strong>
        </p>
      </div>
    </div>
  </div>
</template>

<style lang="scss" scoped>
@import "../../../vue-components/styles/components/cards/cluster";
</style>
