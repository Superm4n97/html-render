<script setup lang="ts">
import { defineAsyncComponent, ref } from "vue";
interface app {
  url: string;
  icon_url: string;
  title: string;
  sub_title: string;
}

interface Props {
  apps?: Array<app>;
}

withDefaults(defineProps<Props>(), {
  apps: () => [],
});

const NavbarItem = defineAsyncComponent(() => import("./NavbarItem.vue"));
const NavbarItemContent = defineAsyncComponent(() => import("./NavbarItemContent.vue"));
const showDrawer = ref(false);

function handleIsActiveChange(isActive: string) {
  showDrawer.value = !!isActive?.length;
}
</script>

<template>
  <navbar-item @on-is-active-change="handleIsActiveChange">
    <template #navbar-item>
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M6.66667 2H2V6.66667H6.66667V2Z"
          stroke="#061B2D"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M14 2H9.33337V6.66667H14V2Z"
          stroke="#061B2D"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M14 9.33334H9.33337V14H14V9.33334Z"
          stroke="#061B2D"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M6.66667 9.33334H2V14H6.66667V9.33334Z"
          stroke="#061B2D"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </template>
    <template #navbar-content>
      <navbar-item-content v-if="showDrawer" class="navbar-dropdown-wrapper" style="right: -30px">
        <ul class="ac-scrollbar p-0 app-drawer">
          <li v-for="app in apps" :key="app.url">
            <a :href="app.url">
              <article class="media">
                <figure class="media-left">
                  <p class="image">
                    <img :src="app.icon_url" />
                  </p>
                </figure>
                <div class="media-content">
                  <div class="content">
                    <p>
                      <strong>{{ app.title }}</strong>
                      <span>{{ app.sub_title }}</span>
                    </p>
                  </div>
                </div>
              </article>
            </a>
          </li>
        </ul>
      </navbar-item-content>
    </template>
  </navbar-item>
</template>
