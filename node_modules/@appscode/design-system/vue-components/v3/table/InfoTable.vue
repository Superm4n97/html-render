<script setup lang="ts">
import { computed, defineAsyncComponent, ref } from "vue";

interface Props {
  isLoaderActive?: boolean;
  isTableEmpty?: boolean;
  tableHeaders?: Array<unknown>;
  removeContentPadding?: boolean;
}

const props = withDefaults(defineProps<Props>(), {
  isLoaderActive: false,
  isTableEmpty: true,
  tableHeaders: () => [],
  removeContentPadding: false,
});

const TableContainer = defineAsyncComponent(() => import("./TableContainer.vue"));

const EmptyTableInfo = defineAsyncComponent(() => import("./EmptyTableInfo.vue"));

const TableRow = defineAsyncComponent(() => import("./TableRow.vue"));

const TableCell = defineAsyncComponent(() => import("./TableCell.vue"));

const CellValue = defineAsyncComponent(() => import("./table-cell/CellValue.vue"));

const loaderCols = ref(5);

const isFullTableLoaderActive = computed(() => {
  return !props.tableHeaders.length;
});
</script>

<template>
  <table-container>
    <table class="table ac-info-table is-fullwidth" :class="{ 'pl-0 pr-0': removeContentPadding }">
      <tbody v-if="isFullTableLoaderActive">
        <table-row v-for="i in loaderCols" :key="i">
          <table-cell>
            <cell-value :is-loader-active="true" />
          </table-cell>
          <table-cell>
            <cell-value :is-loader-active="true" />
          </table-cell>
        </table-row>
      </tbody>
      <tbody
        v-else
        :class="{
          'no-data-available has-text-centered p-10': isTableEmpty,
          'pl-0 pr-0': removeContentPadding,
        }"
      >
        <template v-if="!isTableEmpty">
          <table-row v-for="(tableHeader, idx) in tableHeaders" :key="(tableHeader as string)">
            <table-cell>
              <span class="is-flex is-align-items-center">
                <slot :name="`table-cell-icon-${idx}`" />
                {{ tableHeader }}
              </span>
            </table-cell>
            <table-cell v-if="isLoaderActive">
              <cell-value :is-loader-active="true" />
            </table-cell>
            <table-cell v-else>
              <slot :name="`slot-${idx}`" />
            </table-cell>
          </table-row>
        </template>

        <empty-table-info v-else />
      </tbody>
    </table>
  </table-container>
</template>

<style lang="scss">
// INFO TABLE START
.table.ac-info-table {
  background-color: transparent;
  border-top: 1px solid $color-border;

  &.is-fullwidth {
    tbody {
      tr {
        td {
          &:first-child {
            width: 1%;
          }
        }
      }
    }
  }

  padding: 10px;
  border-radius: 4px;

  tbody {
    display: block;
    padding: 5px 20px;

    tr {
      td {
        border: none;
        font-size: 13px;
        color: $color-text;
        font-weight: 400;
        padding: 3px 0px;
        min-width: 230px;

        &:first-child {
          font-weight: 400;
          padding-right: 10px;
          color: $color-heading;
        }
      }
    }
  }
}
</style>
