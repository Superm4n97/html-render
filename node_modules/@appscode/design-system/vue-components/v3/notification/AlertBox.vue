<script setup lang="ts">
import DOMPurify from "dompurify";
import { computed, defineAsyncComponent, toRefs } from "vue";

const AcButton = defineAsyncComponent(() => import("../button/Button.vue"));

interface Props {
  notificationType?: string;
  content?: string;
  hideIcon?: boolean;
  actionButton?: {
    show: boolean;
    title: string;
    iconClass: string;
    action: (...args: any) => void | undefined;
  };
}

const props = withDefaults(defineProps<Props>(), {
  notificationType: "",
  content: "",
  hideIcon: false,
  actionButton: undefined,
});

const { notificationType, content, hideIcon, actionButton } = toRefs(props);

const iconClass = computed(() => {
  if (notificationType.value === "success") return "fa-check-circle";
  else if (notificationType.value === "info") return "fa-info-circle ";
  else if (notificationType.value === "warning") return "fa-warning";
  else if (notificationType.value === "error") return "fa-times-circle";
  else return "fa-info-circle";
});
const backgroundColor = computed(() => {
  if (notificationType.value === "success") return "is-success";
  else if (notificationType.value === "error") return "is-danger";
  else if (notificationType.value === "warning") return "is-warning";
  else if (notificationType.value === "info") return "is-info";
  else return "";
});

const getSanitizedHtml = (content: string) => {
  return DOMPurify.sanitize(content || "");
};
</script>

<template>
  <!-- alert-message area start  -->
  <!-- use this class name ('.is-info' 'is-success', 'is-danger', 'is-warning') -->
  <div class="ac-notification mb-15" :class="backgroundColor">
    <p>
      <i v-if="!hideIcon" :class="`fa ${iconClass} mr-5`"></i><span v-html="getSanitizedHtml(content)"></span>
      <ac-button
        v-if="actionButton?.show"
        :title="actionButton?.title"
        :icon-class="actionButton?.iconClass"
        data-testid="notification-action-button"
        @click.prevent="actionButton?.action()"
      >
      </ac-button>
    </p>
  </div>
  <!-- alert-message area end -->
</template>
